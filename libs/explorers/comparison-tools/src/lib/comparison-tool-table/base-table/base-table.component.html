<div class="base-table-container">
  @let pagination = shouldPaginate() && data().length !== 0 ? paginationConfig : null;
  <p-table
    #table
    [value]="data()"
    [customSort]="true"
    (sortFunction)="sortCallback($event)"
    breakpoint="0"
    stripedRows
    showGridlines
    [paginator]="!!pagination"
    [paginatorStyleClass]="pagination?.paginatorStyleClass ?? ''"
    [rows]="pagination?.rows ?? undefined"
    [showCurrentPageReport]="!!pagination?.showCurrentPageReport"
    [currentPageReportTemplate]="pagination?.currentPageReportTemplate ?? ''"
    [showPageLinks]="pagination?.showPageLinks ?? null"
  >
    <ng-template pTemplate="emptymessage" let-rowData>
      @if (shouldShowNoDataMessage()) {
        <div class="no-results">No results found...</div>
      }
    </ng-template>

    <ng-template pTemplate="body" let-rowData>
      <tr>
        @for (column of selectedColumns(); track column) {
          @let columnType = column.type;
          @let cellData = rowData[column.data_key];
          @let rowId = rowData['_id'];
          <td [style]="{ width: columnWidth }" [class]="columnType">
            @if (columnType === 'primary') {
              <explorers-primary-identifier-controls
                [label]="cellData"
                [id]="rowId"
                (viewDetailsEvent)="viewDetailsEvent.emit($event)"
              />
            }
            @if (columnType === 'heat_map') {
              <explorers-heatmap-circle [data]="cellData" />
            }
            @if (columnType === 'text') {
              {{ cellData | commaSeparate }}
            }
            @if (columnType.startsWith('link_')) {
              <explorers-comparison-tool-table-link
                [linkText]="cellData?.link_text || column.link_text"
                [linkUrl]="cellData?.link_url || column.link_url"
              />
            }
          </td>
        }
      </tr>
    </ng-template>
  </p-table>
</div>
