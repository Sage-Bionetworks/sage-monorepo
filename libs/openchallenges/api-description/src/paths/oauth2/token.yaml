post:
  tags:
    - OAuth2
  summary: OAuth2 Token Endpoint
  description: |
    Standard OAuth2 token endpoint for exchanging authorization codes for access tokens.
    Also supports refresh token grant and client credentials grant.
  operationId: oauth2Token
  x-audience: [public]
  requestBody:
    required: true
    content:
      application/x-www-form-urlencoded:
        schema:
          type: object
          properties:
            grant_type:
              type: string
              enum: [authorization_code, refresh_token, client_credentials]
              description: OAuth2 grant type
            code:
              type: string
              description: Authorization code (required for authorization_code grant)
            redirect_uri:
              type: string
              format: uri
              description: Redirect URI (required for authorization_code grant)
            client_id:
              type: string
              description: OAuth2 client identifier
            client_secret:
              type: string
              description: OAuth2 client secret
            refresh_token:
              type: string
              description: Refresh token (required for refresh_token grant)
            scope:
              type: string
              description: Requested scope (optional, space-separated)
          required:
            - grant_type
            - client_id
  responses:
    '200':
      description: Access token response
      content:
        application/json:
          schema:
            $ref: ../../components/schemas/OAuth2TokenResponse.yaml
    '400':
      description: Invalid request
      content:
        application/json:
          schema:
            $ref: ../../components/schemas/OAuth2Error.yaml
    '401':
      description: Invalid client credentials
      content:
        application/json:
          schema:
            $ref: ../../components/schemas/OAuth2Error.yaml
    '500':
      $ref: ../../components/responses/InternalServerError.yaml
