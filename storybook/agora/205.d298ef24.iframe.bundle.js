(self.webpackChunksage_monorepo=self.webpackChunksage_monorepo||[]).push([[205],{"./libs/explorers/constants/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{D6:()=>DEBOUNCE_TIME_MS,Wr:()=>LOADING_ICON_COLORS,wv:()=>RESERVED_COMPARISON_TOOL_QUERY_PARAM_KEYS,ME:()=>TOAST_DURATION_MS});const RESERVED_COMPARISON_TOOL_QUERY_PARAM_KEYS=new Set(["pinned","categories","sortFields","sortOrders"]),DEBOUNCE_TIME_MS=500;const LOADING_ICON_COLORS=new(__webpack_require__("./node_modules/.pnpm/@angular+core@20.3.1_@angular+compiler@20.3.1_rxjs@7.8.1_zone.js@0.15.0/node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs").nKC)("LOADING_ICON_COLORS"),TOAST_DURATION_MS=5e3},"./libs/explorers/services/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Cl:()=>ErrorOverlayService,wT:()=>HelperService,gP:()=>LoggerService,fP:()=>PlatformService,LK:()=>SvgIconService,Lc:()=>SynapseApiService});var tslib_es6=__webpack_require__("./node_modules/.pnpm/tslib@2.4.1/node_modules/tslib/tslib.es6.js"),root_effect_scheduler=__webpack_require__("./node_modules/.pnpm/@angular+core@20.3.1_@angular+compiler@20.3.1_rxjs@7.8.1_zone.js@0.15.0/node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),debug_node=__webpack_require__("./node_modules/.pnpm/@angular+core@20.3.1_@angular+compiler@20.3.1_rxjs@7.8.1_zone.js@0.15.0/node_modules/@angular/core/fesm2022/debug_node.mjs"),ngx_cookie_service=__webpack_require__("./node_modules/.pnpm/ngx-cookie-service@18.0.0_@angular+common@20.3.1_@angular+core@20.3.1_@angular+compiler_e8334c058a38fa19ebc0b879681161ba/node_modules/ngx-cookie-service/fesm2022/ngx-cookie-service.mjs"),common=__webpack_require__("./node_modules/.pnpm/@angular+common@20.3.1_@angular+core@20.3.1_@angular+compiler@20.3.1_rxjs@7.8.1_zone.js@0.15.0__rxjs@7.8.1/node_modules/@angular/common/fesm2022/common.mjs");let PlatformService=class PlatformService{platformId=(0,root_effect_scheduler.WQX)(debug_node.Agw);get isBrowser(){return(0,common.UE)(this.platformId)}get isServer(){return(0,common.Vy)(this.platformId)}};PlatformService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],PlatformService);let AppCookieService=class AppCookieService{cookieService=(0,root_effect_scheduler.WQX)(ngx_cookie_service.O);platformService=(0,root_effect_scheduler.WQX)(PlatformService);HIDE_VISUALIZATION_OVERVIEW_COOKIE="hide_visualization_overview";isVisualizationOverviewHidden(){return!this.platformService.isServer&&"1"===this.cookieService.get(this.HIDE_VISUALIZATION_OVERVIEW_COOKIE)}setVisualizationOverviewHidden(hidden){this.platformService.isServer||(hidden?this.cookieService.set(this.HIDE_VISUALIZATION_OVERVIEW_COOKIE,"1",{path:"/"}):this.cookieService.delete(this.HIDE_VISUALIZATION_OVERVIEW_COOKIE,"/"))}};AppCookieService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],AppCookieService);let BreakpointConfigService=class BreakpointConfigService{defaultLargeBreakpoint="992px";_largeBreakpoint=null;get largeBreakpoint(){return null===this._largeBreakpoint&&(this._largeBreakpoint=this.computeLargeBreakpoint()),this._largeBreakpoint}computeLargeBreakpoint(){if("undefined"!=typeof document){const breakpointValue=getComputedStyle(document.documentElement).getPropertyValue("--lg-breakpoint");return breakpointValue?.trim()||this.defaultLargeBreakpoint}return this.defaultLargeBreakpoint}};BreakpointConfigService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],BreakpointConfigService);var resource=__webpack_require__("./node_modules/.pnpm/@angular+core@20.3.1_@angular+compiler@20.3.1_rxjs@7.8.1_zone.js@0.15.0/node_modules/@angular/core/fesm2022/resource.mjs"),rxjs_interop=__webpack_require__("./node_modules/.pnpm/@angular+core@20.3.1_@angular+compiler@20.3.1_rxjs@7.8.1_zone.js@0.15.0/node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),lodash=__webpack_require__("./node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/lodash.js"),combineLatest=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js");let ComparisonToolCoordinatorService=class ComparisonToolCoordinatorService{activeServiceSignal=(0,root_effect_scheduler.vPA)(null);activeService=this.activeServiceSignal.asReadonly();setActive(service){this.activeServiceSignal.set(service)}isActive(service){return this.activeService()===service}};ComparisonToolCoordinatorService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],ComparisonToolCoordinatorService);let ComparisonToolHelperService=class ComparisonToolHelperService{getPaginationParams(event,defaultRowsPerPage=10){return{pageNumber:Math.floor((event.first??0)/(event.rows??defaultRowsPerPage)),pageSize:event.rows??defaultRowsPerPage}}getComparisonToolDataFilename(config){const pageName=config.page.toLowerCase().replaceAll(" ","_"),primaryCategory=config.dropdowns?.[0];if(primaryCategory){return`${pageName}_${primaryCategory.toLowerCase().replaceAll("-","").replaceAll(/\s+/g," ").replaceAll(" ","_")}`}return pageName}buildComparisonToolCsvRows(data,config,siteUrl,heatmapCategoryColumnName="heatmap",linkExportField="link_url"){const exportedColumns=config.columns.filter(col=>!1!==col.is_exported),heatmapColumns=exportedColumns.filter(col=>"heat_map"===col.type),baseColumns=exportedColumns.filter(col=>"heat_map"!==col.type),heatmapMetrics=heatmapColumns.length?this.collectHeatmapMetrics(data,heatmapColumns):[],headerRow=this.buildHeaderRow(exportedColumns,heatmapMetrics,heatmapCategoryColumnName),rows=data.flatMap(item=>this.buildRows({item,baseColumns,heatmapColumns,heatmapMetrics,headerRow,siteUrl,heatmapCategoryColumnName,linkExportField}));return[headerRow,...rows]}buildHeaderRow(columns,heatmapMetrics,heatmapCategoryColumnName){const headerRow=[];let heatmapInserted=!1;for(const column of columns)"heat_map"===column.type?heatmapInserted||(headerRow.push(heatmapCategoryColumnName,...heatmapMetrics),heatmapInserted=!0):headerRow.push(column.data_key);return headerRow}collectHeatmapMetrics(data,heatmapColumns){const firstRecord=data[0];if(!firstRecord)return[];for(const column of heatmapColumns){const heatmapData=firstRecord[column.data_key];if(heatmapData)return Object.keys(heatmapData)}return[]}buildRows(options){const{item,baseColumns,heatmapColumns,heatmapMetrics,headerRow,siteUrl,heatmapCategoryColumnName,linkExportField}=options,baseValues={};for(const column of baseColumns){const itemData=item[column.data_key];baseValues[column.data_key]=null==itemData?"":this.getNonHeatmapValue(column.type,itemData,column,siteUrl,linkExportField)}return 0===heatmapColumns.length?[headerRow.map(key=>baseValues[key]??"")]:heatmapColumns.map(column=>{const rowValues={...baseValues},heatmapData=item[column.data_key];rowValues[heatmapCategoryColumnName]=column.data_key;for(const metric of heatmapMetrics){const metricValue=heatmapData?.[metric];rowValues[metric]=null==metricValue?"":String(metricValue)}return headerRow.map(key=>rowValues[key]??"")})}getNonHeatmapValue(colType,itemData,col,siteUrl,linkExportField){switch(colType){case"text":return Array.isArray(itemData)?itemData.join(","):String(itemData);case"link_external":case"link_internal":{const linkData=itemData;if("link_text"===linkExportField)return linkData.link_text||col.link_text||"";const linkUrlData=linkData.link_url||col.link_url;return"link_internal"===colType?`${siteUrl}/${linkUrlData}`:linkUrlData}default:return String(itemData)}}getSelectedFilters(filters){return filters.reduce((acc,filter)=>{const selectedLabels=filter.options.filter(option=>option.selected).map(option=>option.label);return selectedLabels.length>0&&(acc[filter.query_param_key]=selectedLabels),acc},{})}};ComparisonToolHelperService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],ComparisonToolHelperService);var router2=__webpack_require__("./node_modules/.pnpm/@angular+router@20.3.1_@angular+common@20.3.1_@angular+core@20.3.1_@angular+compiler@20_caad98f0d89bc67acf0b8fdabe1122a3/node_modules/@angular/router/fesm2022/router2.mjs"),src=__webpack_require__("./libs/explorers/constants/src/index.ts"),debounceTime=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js"),map=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/map.js"),distinctUntilChanged=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js"),shareReplay=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js");let comparison_tool_url_service_ComparisonToolUrlService=class ComparisonToolUrlService{router=(0,root_effect_scheduler.WQX)(router2.Ix);route=(0,root_effect_scheduler.WQX)(router2.nX);destroyRef=(0,root_effect_scheduler.WQX)(root_effect_scheduler.abz);params$=this.route.queryParams.pipe((0,debounceTime.B)(50),(0,map.T)(params=>this.deserialize(params)),(0,distinctUntilChanged.F)((prev,curr)=>(0,lodash.isEqual)(prev,curr)),(0,shareReplay.t)({bufferSize:1,refCount:!0}),(0,rxjs_interop.pQ)(this.destroyRef));syncToUrl(state){const currentState=this.deserialize(this.route.snapshot.queryParams);if(this.isStateEqual(currentState,state))return;const queryParams=this.serialize(state);this.router.navigate([],{relativeTo:this.route,queryParams,queryParamsHandling:"merge",replaceUrl:!0})}clearUrl(){this.router.navigate([],{relativeTo:this.route,queryParams:{},replaceUrl:!0})}isStateEqual(current,next){return(0,lodash.isEqual)(current.pinnedItems??[],next.pinnedItems??[])&&(0,lodash.isEqual)(current.categories??[],next.categories??[])&&(0,lodash.isEqual)(current.sortFields??[],next.sortFields??[])&&(0,lodash.isEqual)(current.sortOrders??[],next.sortOrders??[])&&(0,lodash.isEqual)(current.filterSelections??{},next.filterSelections??{})}serialize(state){const params={};return this.serializeArrayParam(params,"categories",state.categories),this.serializeArrayParam(params,"pinned",state.pinnedItems),this.serializeArrayParam(params,"sortFields",state.sortFields),this.serializeNumberArrayParam(params,"sortOrders",state.sortOrders),this.serializeFilterSelections(params,state.filterSelections),params}serializeArrayParam(params,key,value){value&&value.length>0?params[key]=value.map(v=>encodeURIComponent(v)).join(","):void 0!==value&&(params[key]=null)}serializeFilterSelections(params,filterSelections){const currentParams=this.route.snapshot.queryParams,currentFilterKeys=Object.keys(currentParams).filter(key=>!src.wv.has(key));for(const key of currentFilterKeys)params[key]=null;if(filterSelections)for(const[queryParamKey,values]of Object.entries(filterSelections))values&&values.length>0&&(params[queryParamKey]=values.map(v=>encodeURIComponent(v)).join(","))}deserialize(params){const result={};if(params.pinned){const pinnedItems=this.parseCommaSeparatedParam(params.pinned);pinnedItems.length>0&&(result.pinnedItems=pinnedItems)}if(params.categories){const categories=this.parseCommaSeparatedParam(params.categories);categories.length>0&&(result.categories=categories)}if(params.sortFields){const sortFields=this.parseCommaSeparatedParam(params.sortFields);sortFields.length>0&&(result.sortFields=sortFields)}if(params.sortOrders){const sortOrders=this.parseNumberArrayParam(params.sortOrders);sortOrders.length>0&&(result.sortOrders=sortOrders)}const filterSelections=this.deserializeFilterSelections(params);return Object.keys(filterSelections).length>0&&(result.filterSelections=filterSelections),result}deserializeFilterSelections(params){const filterSelections={};for(const[key,value]of Object.entries(params)){if(src.wv.has(key))continue;const values=this.parseCommaSeparatedParam(value);values.length>0&&(filterSelections[key]=values)}return filterSelections}parseCommaSeparatedParam(value){if(null==value)return[];return(Array.isArray(value)?value:[value]).flatMap(entry=>`${entry}`.split(",")).map(entry=>{try{return decodeURIComponent(entry)}catch{return entry}}).filter(entry=>entry.length>0)}serializeNumberArrayParam(params,key,value){value&&value.length>0?params[key]=value.join(","):void 0!==value&&(params[key]=null)}parseNumberArrayParam(value){if(null==value)return[];return(Array.isArray(value)?value.join(","):value).split(",").map(s=>parseInt(s.trim(),10)).filter(n=>!isNaN(n))}};comparison_tool_url_service_ComparisonToolUrlService=(0,tslib_es6.Cg)([(0,debug_node._qm)()],comparison_tool_url_service_ComparisonToolUrlService);var primeng_api=__webpack_require__("./node_modules/.pnpm/primeng@19.0.9_18bfed6a870968de8d6d53a87eef0e78/node_modules/primeng/fesm2022/primeng-api.mjs");let toast_notification_service_ToastNotificationService=class ToastNotificationService{messageService=(0,root_effect_scheduler.WQX)(primeng_api.bg);showError(message){this.messageService.add({severity:"error",sticky:!0,summary:"Error",detail:message}),setTimeout(()=>{this.messageService.clear()},src.ME)}showWarning(message){this.messageService.add({severity:"warn",summary:"Warning",detail:message}),setTimeout(()=>{this.messageService.clear()},src.ME)}showSuccess(message){this.messageService.add({severity:"success",summary:"Success",detail:message}),setTimeout(()=>{this.messageService.clear()},src.ME)}showInfo(message){this.messageService.add({severity:"info",summary:"Info",detail:message}),setTimeout(()=>{this.messageService.clear()},src.ME)}};toast_notification_service_ToastNotificationService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],toast_notification_service_ToastNotificationService);let comparison_tool_service_ComparisonToolService=class ComparisonToolService{toastNotificationService=(0,root_effect_scheduler.WQX)(toast_notification_service_ToastNotificationService);urlService=(0,root_effect_scheduler.WQX)(comparison_tool_url_service_ComparisonToolUrlService);destroyRef=(0,root_effect_scheduler.WQX)(root_effect_scheduler.abz);helperService=(0,root_effect_scheduler.WQX)(ComparisonToolHelperService);coordinatorService=(0,root_effect_scheduler.WQX)(ComparisonToolCoordinatorService);appCookieService=(0,root_effect_scheduler.WQX)(AppCookieService);COLUMN_CACHE_DEPTH=2;DEFAULT_MULTI_SORT_META=[];FIRST_PAGE_NUMBER=0;DEFAULT_VIEW_CONFIG={selectorsWikiParams:{},headerTitle:"",filterResultsButtonTooltip:"Filter results",showSignificanceControls:!0,viewDetailsTooltip:"View detailed results",viewDetailsClick:_rowData=>{},legendEnabled:!0,legendPanelConfig:{colorChartLowerLabel:"",colorChartUpperLabel:"",colorChartText:"",sizeChartLowerLabel:"",sizeChartUpperLabel:"",sizeChartText:""},rowsPerPage:10,rowIdDataKey:"_id",allowPinnedImageDownload:!0,linkExportField:"link_url"};viewConfigSignal=(0,root_effect_scheduler.vPA)(this.DEFAULT_VIEW_CONFIG);configsSignal=(0,root_effect_scheduler.vPA)([]);isLegendVisibleSignal=(0,root_effect_scheduler.vPA)(!1);isVisualizationOverviewVisibleSignal=(0,root_effect_scheduler.vPA)(!this.appCookieService.isVisualizationOverviewHidden());maxPinnedItemsSignal=(0,root_effect_scheduler.vPA)(50);columnsForDropdownsSignal=(0,root_effect_scheduler.vPA)(new Map);unpinnedDataSignal=(0,root_effect_scheduler.vPA)([]);pinnedDataSignal=(0,root_effect_scheduler.vPA)([]);querySignal=(0,root_effect_scheduler.vPA)({categories:[],pinnedItems:[],pageNumber:this.FIRST_PAGE_NUMBER,pageSize:10,multiSortMeta:this.DEFAULT_MULTI_SORT_META,searchTerm:null,filters:[]});isInitializedSignal=(0,root_effect_scheduler.vPA)(!1);heatmapDetailsPanelDataSignal=(0,root_effect_scheduler.vPA)(null);isFilterPanelOpenSignal=(0,root_effect_scheduler.vPA)(!1);pendingFetchesSignal=(0,root_effect_scheduler.vPA)(0);lastSyncedUrlParamsState=null;initialSelection;viewConfig=this.viewConfigSignal.asReadonly();configs=this.configsSignal.asReadonly();isLegendVisible=this.isLegendVisibleSignal.asReadonly();isVisualizationOverviewVisible=this.isVisualizationOverviewVisibleSignal.asReadonly();maxPinnedItems=this.maxPinnedItemsSignal.asReadonly();unpinnedData=this.unpinnedDataSignal.asReadonly();pinnedData=this.pinnedDataSignal.asReadonly();isInitialized=this.isInitializedSignal.asReadonly();heatmapDetailsPanelData=this.heatmapDetailsPanelDataSignal.asReadonly();isFilterPanelOpen=this.isFilterPanelOpenSignal.asReadonly();pendingFetches=this.pendingFetchesSignal.asReadonly();isLoadingTableData=(0,resource.EW)(()=>this.pendingFetches()>0);query=this.querySignal.asReadonly();dropdownSelection=(0,resource.EW)(()=>this.querySignal().categories);pinnedItemsSet=(0,resource.EW)(()=>new Set(this.querySignal().pinnedItems));pinnedItems=(0,resource.EW)(()=>this.querySignal().pinnedItems);pageNumber=(0,resource.EW)(()=>this.querySignal().pageNumber);pageSize=(0,resource.EW)(()=>this.querySignal().pageSize);multiSortMeta=(0,resource.EW)(()=>this.querySignal().multiSortMeta);searchTerm=(0,resource.EW)(()=>this.querySignal().searchTerm);filters=(0,resource.EW)(()=>this.querySignal().filters);selectedFilters=(0,resource.EW)(()=>this.helperService.getSelectedFilters(this.filters()));first=(0,resource.EW)(()=>this.pageNumber()*this.pageSize());visiblePinIds=(0,resource.EW)(()=>{const visiblePinnedData=this.pinnedData(),rowIdKey=this.viewConfig().rowIdDataKey;return visiblePinnedData.map(item=>{const id=item[rowIdKey];return String(id)})});constructor(){(0,resource.QZ)(()=>{const isInitialized=this.isInitialized(),isActive=this.coordinatorService.isActive(this);if(!isInitialized||!isActive)return;const dropdownSelection=this.dropdownSelection(),visiblePinIds=this.visiblePinIds(),multiSortMeta=this.multiSortMeta(),selectedFilters=this.selectedFilters(),state=this.serializeSyncState({dropdownSelection,visiblePinIds,multiSortMeta,selectedFilters});this.syncStateToUrl(state)})}connect(options){this.coordinatorService.setActive(this),this.isInitialized()?this.scheduleUrlSyncFromCurrentState():(this.initialSelection=options.initialSelection,(0,combineLatest.z)([options.config$,options.queryParams$]).pipe((0,rxjs_interop.pQ)(this.destroyRef)).subscribe(([configs,params])=>{this.isInitializedSignal()?this.resolveUrlState(params,{isFirstLoad:!1}):this.initializeFromConfig(configs,params)}))}disconnect(){this.hideHeatmapDetailsPanel(),this.coordinatorService.isActive(this)&&this.coordinatorService.setActive(null)}currentConfig=(0,resource.EW)(()=>this.findConfigForSelection(this.configsSignal(),this.dropdownSelection()));columns=(0,resource.EW)(()=>{const config=this.currentConfig();if(!config)return[];const configColumns=config.columns;if(!configColumns||0===configColumns.length)return[];const savedColumns=this.columnsForDropdownsSignal().get(this.dropdownKey(config.dropdowns));return this.applyColumnPreferences(configColumns,savedColumns)});selectedColumns=(0,resource.EW)(()=>this.columns().filter(col=>col.selected));hasUnselectedColumns(){return this.columns().some(col=>!col.selected)}loadingResultsCount=(0,resource.EW)(()=>this.currentConfig()?.row_count??"");totalResultsCount=(0,root_effect_scheduler.vPA)(0);pinnedResultsCount=(0,root_effect_scheduler.vPA)(0);hasMaxPinnedItems=(0,resource.EW)(()=>this.pinnedResultsCount()>=this.maxPinnedItems());disabledPinTooltip=(0,resource.EW)(()=>`You have already pinned the maximum number of items (${this.maxPinnedItems()}). You must unpin some items before you can pin more.`);setMaxPinnedItems(count){this.maxPinnedItemsSignal.set(count)}initializeFromConfig(configs,params){this.configsSignal.set(configs??[]);const selection=this.resolveInitialDropdownSelection(params,configs),initialSort=this.resolveInitialSortMeta(params),initialFilters=this.resolveInitialFilters(params,configs,selection);this.updateQuery({categories:selection,multiSortMeta:initialSort,filters:initialFilters});const columnsMap=new Map;for(const config of configs)columnsMap.set(this.dropdownKey(config.dropdowns),this.applyColumnPreferences(config.columns));this.columnsForDropdownsSignal.set(columnsMap),this.initialSelection=void 0,this.resolveUrlState(params,{isFirstLoad:!0}),this.isInitializedSignal.set(!0)}resolveInitialDropdownSelection(params,configs){const selectionSource=params.categories??void 0??this.initialSelection??[];return this.normalizeSelection(selectionSource,configs)}resolveInitialSortMeta(params){if(params.sortFields&&params.sortFields.length>0)return this.convertArraysToSortMeta(params.sortFields,params.sortOrders??[]);const defaultSort=this.viewConfigSignal().defaultSort;return defaultSort&&defaultSort.length>0?defaultSort:[]}resolveInitialFilters(params,configs,selection){const targetConfig=this.findConfigForSelection(configs,selection),filters=this.convertFiltersFromConfig(targetConfig?.filters);return this.createFiltersWithSelections(filters,params.filterSelections)}findConfigForSelection(configs,selection){if(!configs.length)return null;if(!selection.length)return configs[0];const exactMatch=configs.find(config=>(0,lodash.isEqual)(config.dropdowns??[],selection));if(exactMatch)return exactMatch;return configs.find(config=>this.isPrefix(selection,config.dropdowns))??configs[0]}getFiltersForSelection(selection){const config=this.findConfigForSelection(this.configsSignal(),selection);return this.convertFiltersFromConfig(config?.filters)}convertFiltersFromConfig(filterConfigs){return filterConfigs&&0!==filterConfigs.length?filterConfigs.map(config=>({name:config.name,data_key:config.data_key,short_name:config.short_name,query_param_key:config.query_param_key,options:config.values.map(value=>({label:value,selected:!1}))})):[]}createFiltersWithSelections(filters,selections){const selectionMap=selections??{};return filters.map(filter=>{const selectedValues=selectionMap[filter.query_param_key],selectedSet=new Set(selectedValues??[]);return{...filter,options:filter.options.map(option=>({...option,selected:selectedSet.has(option.label)}))}})}setDropdownSelection(selection){const configs=this.configsSignal();if(!configs.length)return void this.updateDropdownSelectionIfChanged(selection??[]);const normalizedSelection=this.normalizeSelection(selection,configs);this.updateDropdownSelectionIfChanged(normalizedSelection);const config=this.currentConfig();if(config?.columns&&config.columns.length>0){const key=this.dropdownKey(config.dropdowns);this.columnsForDropdownsSignal.update(columnsMap=>{const next=new Map(columnsMap),savedColumns=columnsMap.get(key);return next.set(key,this.applyColumnPreferences(config.columns,savedColumns)),next})}}setLegendVisibility(visible){this.isLegendVisibleSignal.set(visible)}toggleLegend(){this.isLegendVisibleSignal.update(visible=>!visible)}setVisualizationOverviewVisibility(visible){this.isVisualizationOverviewVisibleSignal.set(visible)}toggleVisualizationOverview(){this.isVisualizationOverviewVisibleSignal.update(visible=>!visible)}showHeatmapDetailsPanel(rowData,cellData,columnKey,event){const transform=this.viewConfig().heatmapCircleClickTransformFn;if(!transform)return;const data=transform({rowData,cellData,columnKey});data&&this.heatmapDetailsPanelDataSignal.set({data,event})}hideHeatmapDetailsPanel(){this.heatmapDetailsPanelDataSignal.set(null)}toggleFilterPanel(){this.isFilterPanelOpenSignal.update(isOpen=>!isOpen)}openFilterPanel(){this.isFilterPanelOpenSignal.set(!0)}closeFilterPanel(){this.isFilterPanelOpenSignal.set(!1)}setViewConfig(viewConfig){this.viewConfigSignal.set({...this.DEFAULT_VIEW_CONFIG,...viewConfig}),this.setLegendVisibility(!1);this.isVisualizationOverviewHiddenByUser()||this.setVisualizationOverviewVisibility(!0)}isVisualizationOverviewHiddenByUser(){return this.appCookieService.isVisualizationOverviewHidden()}setVisualizationOverviewHiddenByUser(hidden){this.appCookieService.setVisualizationOverviewHidden(hidden)}isPinned(id){return this.pinnedItemsSet().has(id)}togglePin(id){this.isPinned(id)?this.unpinItem(id):this.pinItem(id)}pinItem(id){this.hasMaxPinnedItems()?this.toastNotificationService.showWarning(`You have reached the maximum number of pinned items (${this.maxPinnedItems()}). Please unpin an item before pinning a new one.`):this.isPinned(id)||this.setPinnedItems([...this.visiblePinIds(),id])}unpinItem(id){this.setPinnedItems(this.visiblePinIds().filter(item=>item!==id))}pinList(ids){const visiblePins=new Set(this.visiblePinIds());let itemsAdded=0;for(const id of ids){if(visiblePins.size>=this.maxPinnedItems()){const messagePrefix=0===itemsAdded?"No rows":`Only ${itemsAdded} rows`;this.toastNotificationService.showWarning(`${messagePrefix} were pinned, because you reached the maximum of ${this.maxPinnedItems()} pinned items.`);break}visiblePins.has(id)||(visiblePins.add(id),itemsAdded++)}this.setPinnedItems(Array.from(visiblePins))}setPinnedItems(items){const deduplicatedItems=items?Array.from(new Set(items)):[];this.updateQuery({pinnedItems:deduplicatedItems})}resetPinnedItems(){this.setPinnedItems([])}toggleColumn(column){const config=this.currentConfig();config&&this.columnsForDropdownsSignal.update(cols=>{const key=this.dropdownKey(config.dropdowns),columns=cols.get(key);if(!columns)return cols;const targetIndex=columns.findIndex(col=>col.data_key===column.data_key);if(-1===targetIndex)return cols;const updatedColumns=[...columns];updatedColumns[targetIndex]={...updatedColumns[targetIndex],selected:!updatedColumns[targetIndex].selected};const next=new Map(cols);return next.set(key,updatedColumns),next})}setUnpinnedData(unpinnedData){this.unpinnedDataSignal.set(unpinnedData),this.completeFetch()}setPinnedData(pinnedData){this.pinnedDataSignal.set(pinnedData),this.completeFetch()}startFetch(){this.pendingFetchesSignal.update(count=>count+1)}completeFetch(){this.pendingFetchesSignal.update(count=>Math.max(0,count-1))}updateQuery(query){this.querySignal.update(current=>({...current,...query}))}handleLazyLoad(event){const defaultRowsPerPage=this.viewConfigSignal().rowsPerPage,{pageNumber,pageSize}=this.helperService.getPaginationParams(event,defaultRowsPerPage),currentPageNumber=this.pageNumber(),currentPageSize=this.pageSize();pageNumber===currentPageNumber&&pageSize===currentPageSize||this.updateQuery({pageNumber,pageSize})}updateDropdownSelectionIfChanged(selection){if((0,lodash.isEqual)(this.dropdownSelection(),selection))return;const currentPins=this.pinnedItems(),selectedFilters=this.selectedFilters(),newFilters=this.getFiltersForSelection(selection),newFiltersWithSelections=this.createFiltersWithSelections(newFilters,selectedFilters);this.updateQuery({categories:selection,filters:newFiltersWithSelections,pinnedItems:currentPins,pageNumber:this.FIRST_PAGE_NUMBER})}normalizeSelection(selection,configs){if(!configs.length)return[];const defaultSelection=[...configs[0].dropdowns??[]];if(!selection||0===selection.length)return defaultSelection;const exactMatch=configs.find(config=>(0,lodash.isEqual)(config.dropdowns??[],selection));if(exactMatch)return[...exactMatch.dropdowns];const prefixMatch=configs.find(config=>this.isPrefix(selection,config.dropdowns));return prefixMatch?[...prefixMatch.dropdowns]:defaultSelection}isPrefix(prefix,target){const normalizedTarget=target??[];return!(prefix.length>normalizedTarget.length)&&prefix.every((value,index)=>normalizedTarget[index]===value)}applyColumnPreferences(configColumns,savedColumns){const visibleColumns=configColumns.filter(column=>!column.is_hidden);if(!savedColumns?.length)return visibleColumns.map(column=>({...column,selected:!0}));const selectionMap=new Map(savedColumns.map(col=>[col.data_key,col.selected]));return visibleColumns.map(column=>({...column,selected:selectionMap.get(column.data_key)??!0}))}dropdownKey(dropdowns){const normalized=dropdowns??[];return normalized.length<=this.COLUMN_CACHE_DEPTH?JSON.stringify(normalized):JSON.stringify(normalized.slice(0,this.COLUMN_CACHE_DEPTH))}setSort(multiSortMeta){const newSort=multiSortMeta||this.DEFAULT_MULTI_SORT_META,currentSort=this.querySignal().multiSortMeta;if(currentSort===newSort||(0,lodash.isEqual)(currentSort,newSort))return;if(0===newSort.length){const defaultSort=this.viewConfigSignal().defaultSort;if(defaultSort&&defaultSort.length>0)return void this.updateQuery({pageNumber:this.FIRST_PAGE_NUMBER,multiSortMeta:defaultSort})}const clonedSort=newSort.map(s=>({field:s.field,order:s.order}));this.updateQuery({pageNumber:this.FIRST_PAGE_NUMBER,multiSortMeta:clonedSort})}resolveUrlState(params,options){if(!this.coordinatorService.isActive(this))return;const queryUpdates={};if(!options.isFirstLoad){const resolvedCategories=this.resolveCategoriesFromUrl(params.categories);if(resolvedCategories){queryUpdates.categories=resolvedCategories,queryUpdates.pageNumber=this.FIRST_PAGE_NUMBER;const newFilters=this.getFiltersForSelection(resolvedCategories);queryUpdates.filters=this.createFiltersWithSelections(newFilters,params.filterSelections)}else{const resolvedFilters=this.resolveFiltersFromUrl(params.filterSelections);resolvedFilters&&(queryUpdates.filters=resolvedFilters)}const resolvedSort=this.resolveSortFromUrl(params.sortFields,params.sortOrders);resolvedSort&&(queryUpdates.multiSortMeta=resolvedSort)}const resolvedPinnedItems=this.resolvePinnedItemsFromUrl(params.pinnedItems);null!==resolvedPinnedItems&&(queryUpdates.pinnedItems=resolvedPinnedItems),Object.keys(queryUpdates).length>0&&this.updateQuery(queryUpdates),options.isFirstLoad||this.updateSyncedStateCache()}resolveFiltersFromUrl(urlFilterSelections){const selections=urlFilterSelections??{},lastSyncedSelections=this.lastSyncedUrlParamsState?.filterSelections??{};return(0,lodash.isEqual)(selections,lastSyncedSelections)?null:this.createFiltersWithSelections(this.filters(),selections)}resolveSortFromUrl(sortFields,sortOrders){if(!sortFields?.length)return null;const sortMeta=this.convertArraysToSortMeta(sortFields,sortOrders??[]),lastSyncedSortMeta=this.convertArraysToSortMeta(this.lastSyncedUrlParamsState?.sortFields??[],this.lastSyncedUrlParamsState?.sortOrders??[]);return(0,lodash.isEqual)(sortMeta,lastSyncedSortMeta)||(0,lodash.isEqual)(sortMeta,this.multiSortMeta())?null:sortMeta}resolveCategoriesFromUrl(urlCategories){if(!urlCategories)return null;const normalizedSelection=this.normalizeSelection(urlCategories,this.configsSignal());return(0,lodash.isEqual)(normalizedSelection,this.lastSyncedUrlParamsState?.categories??[])||(0,lodash.isEqual)(normalizedSelection,this.dropdownSelection())?null:normalizedSelection}resolvePinnedItemsFromUrl(urlPinnedItems){const pinnedItems=urlPinnedItems??[];return(0,lodash.isEqual)(pinnedItems,this.lastSyncedUrlParamsState?.pinnedItems??[])?null:pinnedItems.length>0?Array.from(new Set(pinnedItems)):[]}syncStateToUrl(state){(0,lodash.isEqual)(this.lastSyncedUrlParamsState,state)||(this.lastSyncedUrlParamsState=state,this.urlService.syncToUrl(state))}serializeSyncState(options){const pinned=options.visiblePinIds,{sortFields,sortOrders}=this.convertSortMetaToArrays(options.multiSortMeta),defaultSort=this.viewConfigSignal().defaultSort,isDefaultSort=defaultSort&&(0,lodash.isEqual)(options.multiSortMeta,defaultSort),hasFilters=Object.keys(options.selectedFilters).length>0;return{pinnedItems:pinned.length?pinned:null,categories:options.dropdownSelection.length?options.dropdownSelection:null,sortFields:!isDefaultSort&&sortFields.length?sortFields:null,sortOrders:!isDefaultSort&&sortOrders.length?sortOrders:null,filterSelections:hasFilters?options.selectedFilters:null}}syncCurrentStateToUrl(){this.syncStateToUrl(this.serializeSyncState({dropdownSelection:this.dropdownSelection(),visiblePinIds:this.visiblePinIds(),multiSortMeta:this.multiSortMeta(),selectedFilters:this.selectedFilters()}))}convertSortMetaToArrays(multiSortMeta){if(!multiSortMeta||0===multiSortMeta.length)return{sortFields:[],sortOrders:[]};const sortFields=[],sortOrders=[];for(const meta of multiSortMeta)meta.field&&(sortFields.push(meta.field),sortOrders.push(meta.order??1));return{sortFields,sortOrders}}convertArraysToSortMeta(sortFields,sortOrders){return sortFields.map((field,index)=>({field,order:sortOrders[index]??1}))}updateSyncedStateCache(){this.lastSyncedUrlParamsState=this.serializeSyncState({visiblePinIds:this.visiblePinIds(),dropdownSelection:this.dropdownSelection(),multiSortMeta:this.multiSortMeta(),selectedFilters:this.selectedFilters()})}scheduleUrlSyncFromCurrentState(){queueMicrotask(()=>{this.coordinatorService.isActive(this)&&(this.lastSyncedUrlParamsState=null,this.syncCurrentStateToUrl())})}static ctorParameters=()=>[]};comparison_tool_service_ComparisonToolService=(0,tslib_es6.Cg)([(0,debug_node._qm)(),(0,tslib_es6.Sn)("design:paramtypes",[])],comparison_tool_service_ComparisonToolService);new root_effect_scheduler.nKC("EXPLORERS_CONFIG");var asyncToGenerator=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.28.3/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),asyncIterator=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.28.3/node_modules/@babel/runtime/helpers/esm/asyncIterator.js"),dist_src=__webpack_require__("./node_modules/.pnpm/@octokit+rest@22.0.0/node_modules/@octokit/rest/dist-src/index.js"),from=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/from.js");let GitHubService=class GitHubService{octokit=new dist_src.E;getCommitSHA(tagName){return(0,from.H)(this.fetchCommitSHA(tagName))}fetchCommitSHA(tagName){var _this=this;return(0,asyncToGenerator.A)(function*(){const iterator=_this.octokit.paginate.iterator(_this.octokit.rest.repos.listTags,{owner:"Sage-Bionetworks",repo:"sage-monorepo",per_page:100});var _iteratorError,_iteratorAbruptCompletion=!1,_didIteratorError=!1;try{for(var _step,_iterator=(0,asyncIterator.A)(iterator);_iteratorAbruptCompletion=!(_step=yield _iterator.next()).done;_iteratorAbruptCompletion=!1){const{data:tags}=_step.value;{const tag=tags.find(t=>t.name===tagName);if(tag)return _this.getShortSHA(tag.commit.sha)}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorAbruptCompletion&&null!=_iterator.return&&(yield _iterator.return())}finally{if(_didIteratorError)throw _iteratorError}}return""})()}getShortSHA(fullSHA){return fullSHA&&40===fullSHA.length?fullSHA.slice(0,7):""}};GitHubService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],GitHubService);let HelperService=class HelperService{getScrollTop(){if("undefined"==typeof window||"undefined"==typeof document)return{x:0,y:0};const supportPageOffset=void 0!==window.pageXOffset,isCSS1Compat="CSS1Compat"===(document.compatMode||"");return supportPageOffset?{x:window.pageXOffset,y:window.pageYOffset}:isCSS1Compat?{x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop}:{x:document.body.scrollLeft,y:document.body.scrollTop}}getOffset(el){if("undefined"==typeof window||"undefined"==typeof document||!el)return{top:0,left:0};const rect=el.getBoundingClientRect(),scroll=this.getScrollTop();return{top:rect.top+scroll.y,left:rect.left+scroll.x}}getPanelUrl(basePath,activePanel,activeParent){return`${basePath}/${""===activeParent?activePanel:`${activeParent}/${activePanel}`}`}getActivePanelAndParent(panels,panel){if(panel.children)return{activePanel:panel.children[0].name,activeParent:panel.name};if(panels.find(p=>p.name===panel.name))return{activePanel:panel.name,activeParent:""};{const parent=panels.find(p=>p.children?.find(c=>c.name===panel.name));return{activePanel:panel.name,activeParent:parent?.name??""}}}findPanelByName(panels,panelName){const topLevelPanel=panels.find(p=>p.name===panelName);if(topLevelPanel)return topLevelPanel;for(const panel of panels)if(panel.children){const childPanel=panel.children.find(child=>child.name===panelName);if(childPanel)return childPanel}}getUrlParam(name){if("undefined"==typeof window)return null;const queryString=window.location.search;return new URLSearchParams(queryString).get(name)}getHashFragment(){return window.location.hash.slice(1)}encodeParenthesesForwardSlashes(uri){return uri.replace(/\(([^)]*)\)/g,(match,content)=>`(${content.replace(/\//g,"%2F")})`).replace(/\(/g,"%28").replace(/\)/g,"%29")}getNumberFromCSSValue(cssValue){return parseFloat(cssValue)}getSignificantFigures(n,sig=2){let sign=1;if(0===n)return 0;n<0&&(n*=-1,sign=-1);const mult=Math.pow(10,sig-Math.floor(Math.log(n)/Math.LN10)-1);return Math.round(n*mult)/mult*sign}cleanFilename(filename){return filename.replaceAll(/[<>:"\\/|?*]/g,"_").replaceAll(" ","_")}};HelperService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],HelperService);var core=__webpack_require__("./node_modules/.pnpm/@angular+core@20.3.1_@angular+compiler@20.3.1_rxjs@7.8.1_zone.js@0.15.0/node_modules/@angular/core/fesm2022/core.mjs"),breadcrumbs=__webpack_require__("./node_modules/.pnpm/@sentry+core@10.38.0/node_modules/@sentry/core/build/esm/breadcrumbs.js"),esm_exports=__webpack_require__("./node_modules/.pnpm/@sentry+core@10.38.0/node_modules/@sentry/core/build/esm/exports.js");let LoggerService=class LoggerService{log(message,data){(0,core.isDevMode)()&&(data?console.log("[LOG]",message,data):console.log("[LOG]",message)),breadcrumbs.Z({message,level:"info",data})}warn(message,data){data?console.warn("[WARN]",message,data):console.warn("[WARN]",message),breadcrumbs.Z({message,level:"warning",data})}error(message,error){error?console.error("[ERROR]",message,error):console.error("[ERROR]",message),error?esm_exports.Cp(error):esm_exports.wd(message,"error")}};LoggerService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],LoggerService);var platform_browser=__webpack_require__("./node_modules/.pnpm/@angular+platform-browser@20.3.1_@angular+animations@20.3.1_@angular+core@20.3.1_@angul_3d3c35849bcecff9d44a8fcc855c52e4/node_modules/@angular/platform-browser/fesm2022/platform-browser.mjs"),filter=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/filter.js");let MetaTagService=class MetaTagService{titleService=(0,root_effect_scheduler.WQX)(platform_browser.hE);metaService=(0,root_effect_scheduler.WQX)(platform_browser.W8);router=(0,root_effect_scheduler.WQX)(router2.Ix);activatedRoute=(0,root_effect_scheduler.WQX)(router2.nX);destroyRef=(0,root_effect_scheduler.WQX)(root_effect_scheduler.abz);initialize(defaultTitle){this.router.events.pipe((0,rxjs_interop.pQ)(this.destroyRef),(0,filter.p)(event=>event instanceof router2.wF),(0,map.T)(()=>this.activatedRoute),(0,map.T)(this.getDeepestRoute),(0,filter.p)(route=>"primary"===route.outlet),(0,map.T)(route=>({data:route.snapshot.data,snapshot:route.snapshot}))).subscribe(({data,snapshot})=>{this.setPageTitle(data,snapshot,defaultTitle),this.setPageDescription(data,snapshot)})}getDeepestRoute(route){for(;route.firstChild;)route=route.firstChild;return route}setPageTitle(data,currentSnapshot,defaultTitle){const pageTitle="function"==typeof data.title?data.title(currentSnapshot)||defaultTitle:data.title||defaultTitle;this.titleService.setTitle(pageTitle)}setPageDescription(data,currentSnapshot){let description=data.description;"function"==typeof description&&(description=description(currentSnapshot)),description?this.metaService.updateTag({name:"description",content:description}):this.metaService.removeTag("name='description'")}};MetaTagService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],MetaTagService);let ErrorOverlayService=class ErrorOverlayService{logger=(0,root_effect_scheduler.WQX)(LoggerService);errorMessage=(0,root_effect_scheduler.vPA)(null);hasActiveError=(0,resource.EW)(()=>null!==this.errorMessage());activeErrorMessage=(0,resource.EW)(()=>this.errorMessage()??"Something went wrong.");showError(message){null===this.errorMessage()&&this.errorMessage.set(message),this.logger.error(message)}reloadPage(){window.location.reload()}};ErrorOverlayService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],ErrorOverlayService);var fesm2022_module=__webpack_require__("./node_modules/.pnpm/@angular+common@20.3.1_@angular+core@20.3.1_@angular+compiler@20.3.1_rxjs@7.8.1_zone.js@0.15.0__rxjs@7.8.1/node_modules/@angular/common/fesm2022/module.mjs");const SeoMetaId={AUTHOR:"AUTHOR",DESCRIPTION:"DESCRIPTION",IMAGE:"IMAGE",PUBLISH_DATE:"PUBLISH_DATE",TITLE:"TITLE",TWITTER_TITLE:"TWITTER_TITLE",TWITTER_CARD:"TWITTER_CARD",TWITTER_DESCRIPTION:"TWITTER_DESCRIPTION",TWITTER_IMAGE:"TWITTER_IMAGE",TWITTER_IMAGE_ALT:"TWITTER_IMAGE_ALT",TWITTER_SITE:"TWITTER_SITE",TYPE:"TYPE",URL:"URL"};let JsonLdService=class JsonLdService{document=(0,root_effect_scheduler.WQX)(root_effect_scheduler.qQL);addData(jsonLdData,renderer2){const script=renderer2.createElement("script");script.type="application/ld+json",script.text=`${JSON.stringify(jsonLdData)}`,renderer2.appendChild(this.document.head,script)}};JsonLdService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],JsonLdService);let SeoService=class SeoService{titleService=(0,root_effect_scheduler.WQX)(platform_browser.hE);metaService=(0,root_effect_scheduler.WQX)(platform_browser.W8);jsonLdService=(0,root_effect_scheduler.WQX)(JsonLdService);setData(seoData,renderer2){const title=seoData.title,metas=this.buildMetas(seoData),jsonLds=seoData.jsonLds;this.setTitle(title),this.setMetas(metas),this.setJsonLds(jsonLds,renderer2)}setTitle(title){this.titleService.setTitle(title)}setMetas(metas){(0,lodash.forIn)(SeoMetaId,id=>{metas[id]&&this.metaService.updateTag(metas[id])})}setJsonLds(jsonLds,renderer2){jsonLds.forEach(j=>this.jsonLdService.addData(j,renderer2))}buildMetas(seoData){return{AUTHOR:{name:"author",content:"The OpenChallenges Team"},DESCRIPTION:{name:"description",property:"og:description",content:seoData.description},IMAGE:{name:"image",property:"og:image",content:seoData.imageUrl},PUBLISH_DATE:{name:"publish_date",property:"og:publish_date",content:seoData.publishDate},TITLE:{name:"title",property:"og:title",content:seoData.title},TWITTER_TITLE:{name:"twitter:title",content:seoData.title},TWITTER_CARD:{name:"twitter:card",content:"summary_large_image"},TWITTER_DESCRIPTION:{name:"twitter:description",content:seoData.description},TWITTER_IMAGE:{name:"twitter:image",content:seoData.imageUrl},TWITTER_IMAGE_ALT:{name:"twitter:image:alt",content:seoData.imageAlt},TWITTER_SITE:{name:"twitter:site"},TYPE:{property:"og:type",content:"website"},URL:{name:"og:url",content:seoData.url}}}};SeoService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],SeoService);var observable_of=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/of.js");let SvgIconService=class SvgIconService{http=(0,root_effect_scheduler.WQX)(fesm2022_module.Qq);sanitizer=(0,root_effect_scheduler.WQX)(platform_browser.up);svgCache=new Map;platformId=(0,root_effect_scheduler.WQX)(debug_node.Agw);commonSvgPaths=["explorers-assets/icons/card-arrow.svg","explorers-assets/icons/caret-right-outline.svg","explorers-assets/icons/close.svg","explorers-assets/icons/cog.svg","explorers-assets/icons/column.svg","explorers-assets/icons/download.svg","explorers-assets/icons/external-link.svg","explorers-assets/icons/gct.svg","explorers-assets/icons/info-circle.svg","explorers-assets/icons/link.svg","explorers-assets/icons/pin.svg","explorers-assets/icons/search.svg","explorers-assets/icons/trash.svg"];constructor(){this.preloadCommonSvgs()}preloadCommonSvgs(){this.commonSvgPaths.forEach(path=>{this.getSvg(path).subscribe()})}isValidImagePath(path){return!function isExternalLink(url){return!("string"!=typeof url||!url.trim().startsWith("http"))}(path)&&(Boolean(path)&&/^[a-z-]+-assets\/icons\/[^/]+\.svg$/.test(path))}getSvg(path){if((0,common.Vy)(this.platformId))return(0,observable_of.of)("");if(!this.isValidImagePath(path))throw new Error("Invalid SVG path");const cached=this.svgCache.get(path);if(cached)return cached;const request=this.http.get(path,{responseType:"text"}).pipe((0,map.T)(svg=>this.sanitizer.bypassSecurityTrustHtml(svg)),(0,shareReplay.t)(1));return this.svgCache.set(path,request),request}static ctorParameters=()=>[]};SvgIconService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"}),(0,tslib_es6.Sn)("design:paramtypes",[])],SvgIconService);var throwError=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/throwError.js"),tap=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/tap.js"),catchError=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/catchError.js"),switchMap=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),sanitize_html=__webpack_require__("./node_modules/.pnpm/sanitize-html@2.13.0/node_modules/sanitize-html/index.js"),sanitize_html_default=__webpack_require__.n(sanitize_html);let SynapseApiService=class SynapseApiService{http=(0,root_effect_scheduler.WQX)(fesm2022_module.Qq);cache={wikis:{},terms:null};getWikiMarkdown(ownerId,wikiId){const key=ownerId+wikiId;return this.cache.wikis[key]?(0,observable_of.of)(this.cache.wikis[key]):this.http.get("https://repo-prod.prod.sagebase.org/repo/v1/entity/"+ownerId+"/wiki/"+wikiId).pipe((0,tap.M)(wiki=>{this.cache.wikis[key]=wiki}),(0,catchError.W)(error=>(console.error("Error loading wiki:",error),(0,throwError.$)(()=>new Error("Failed to fetch wiki")))))}getTermsOfService(){return this.cache.terms?(0,observable_of.of)(this.cache.terms):this.http.get("https://repo-prod.prod.sagebase.org/auth/v1/termsOfUse2/info").pipe((0,switchMap.n)(info=>this.http.get(info.termsOfServiceUrl,{responseType:"text"}).pipe((0,map.T)(markdown=>(this.cache.terms=markdown,markdown)))),(0,catchError.W)(error=>(console.error("Failed to fetch Terms of Service:",error),(0,throwError.$)(()=>new Error("Failed to fetch Terms of Service")))))}renderHtml(html){let sanitized=sanitize_html_default()(html);return sanitized=sanitized.replace(/\*\*(.*?)\*\*/g,this.replaceBold),sanitized=sanitized.replace(/\[(.+?)\]\((.+?)\)/g,this.replaceLinks),sanitized=sanitized.replace(/([a-zA-Z0-9.*_-]+@[a-zA-Z0-9 .*_-]+\.[a-zA-Z0-9*_-]+)/gi,this.replaceEmail),sanitized=sanitized.replace(/\${(.*?)}/g,this.replaceVariable),sanitized}replaceLinks(match,text,url){return url.startsWith("syn")&&(url="https://synapse.org/#!Synapse:"+url),'<a href="'+url+'" target="_blank">'+text+"</a>"}replaceBold(match,content){return"<b>"+content+"</b>"}replaceVariable(match,content){let params=null;try{const contentArr=content.split("?");params=new URLSearchParams(contentArr.length>1?contentArr[1]:contentArr[0])}catch(err){console.error(err)}if(params){if(params.has("fileName"))return'<img src="'+params.get("fileName")+'" alt="'+(params.get("amp;altText")||"")+'" />';if(params.has("vimeoId"))return'<iframe src="https://player.vimeo.com/video/'+params.get("vimeoId")+'?autoplay=0&speed=1" frameborder="0" allow="autoplay; encrypted-media" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'}return""}replaceEmail(match,content){return(content=content.replace(/(\s|\*)/g,""))?'<a class="link email-link" href="mailto:'+content+'">'+content+"</a>":content}};SynapseApiService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],SynapseApiService);var empty=__webpack_require__("./node_modules/.pnpm/rxjs@7.8.1/node_modules/rxjs/dist/esm5/internal/observable/empty.js");let VersionService=class VersionService{platformService=(0,root_effect_scheduler.WQX)(PlatformService);logger=(0,root_effect_scheduler.WQX)(LoggerService);gitHubService=(0,root_effect_scheduler.WQX)(GitHubService);getDataVersion$(dataVersionService){return this.platformService.isServer?empty.w:dataVersionService.getDataVersion().pipe((0,map.T)(data=>this.formatDataVersion(data)),(0,catchError.W)(error=>(this.logger.error("Error loading data version",error),(0,throwError.$)(()=>error))))}getSiteVersion$(config){return this.platformService.isServer?empty.w:this.gitHubService.getCommitSHA(config.tagName).pipe((0,map.T)(sha=>this.formatSiteVersion(sha,config)),(0,catchError.W)(error=>(this.logger.error("Error loading commit SHA",error),(0,observable_of.of)(this.formatSiteVersion("",config)))))}formatDataVersion(dataVersion){return`${dataVersion.data_file}-v${dataVersion.data_version}`}formatSiteVersion(sha,config){const appVersion=this.formatAppVersion(config.appVersion);return appVersion?sha?`${appVersion}-${sha}`:appVersion:sha}formatAppVersion(appVersion){return appVersion?appVersion.replace(/-rc\d+$/,""):""}};VersionService=(0,tslib_es6.Cg)([(0,debug_node._qm)({providedIn:"root"})],VersionService)},"?09a7":()=>{},"?14f7":()=>{},"?7342":()=>{},"?767b":()=>{},"?8945":()=>{}}]);